# RenderingPerformance

## Intro


## 1. 60 FPS
- 각 프레임마다 1.66ms 가량의 시간이 할당된다.
- 브라우저는 실행 준비를 해야하므로 10ms 내에 모든 작업을 완료해야한다.
- 이 제한 시간을 충족하지 못하면 프레임 속도가 떨어지고 화며넹서 콘텐츠가 떨리게된다.


## 2. 필셀 파이프 라인
![](/resource/img/etc/frame-full.jpg)

### 자바스크립트
일반적으로 자바스크립트는 jQuery의 animate 함수 데이터 집합 정렬 또는 페이지 DOM요소 추가 등 시각적 변화를 일으키는 작업을 처리하는 데 사용된다. 하지만 반드시 자바스크립트로 시각적변화를 트리거 할 필요는 없다.
CSS Animations, Transitions 및 Web Animations API도 널리 사용된다.

### 스타일 계산
이는 .headline 또는 .nav > .nav__time 등의 매칭 선택기에 따라 어떤 CSS 규칙을 어떤 요소에 적용하지 계산하는 프로세스다. 여기에서 규칙이 알려지면 적용되고 각 요소의 마지막 스타일을 계산하게 된다.

### 레이아웃
부라우저 요소에 어떤 규칙을 적용할지 알게 되면 화면에서 얼마의 공간을 차지하고 어디에 배치되는지 계산하기 시작할 수 있다. 웹의 레이아웃 모델은 한 요소가 다른 요소에 영향을 줄 수 있음을 의미한다. 예를 들어 , \<body\> 요소의 너비는 일반적으로 하위 요소의 너비 등 트리의 위아래 모든 곳에 영향을 주며, 따라서 이 프로세스는 부라우저에 상당향 영향을 줄 수 있다.

### 페인트
페인트는 픽셀을 채우는 프로세스입니다. 이는 텍스트, 색, 이미지 경계 및 그림자 등 요소의 모든 시각적 부분을 그리는 작업을 포함한다. 그리기는 일반적으로 레이어라고 하는 다수의 표현에서 수행된다.

### 합성(Compositing)
페이지의 여러 부분이 잠재적으로 여러 레이어로 그려졌기 때문에 페이지가 정확히 렌더링되려면 정확한 순서로 화면에 그려야한다. 실수로 한 요소가 다른 요소 위에 잘못 나타날 수 있기 떄문에 이는 다른 요소와 겹치는 요소가 있는 경우에 특히 중요하다.


파이프라인의 각 부분에서 버벅거리는 현상이 발생할 수 있으므로 코드가 파이프라인의 어떤 부분을 트리거하는지 정확히 이해하는 것이 중요하다.

페인트와 함께 사용되는 '래스터화'라는 용어를 들어본 적이 있을 것입니다. 그 이유는 페인트가 실제로 
1. 그리기 호출 목록 생성
2. 픽셀 채우기 등   
두 작업이기 떄문이다. 후자를 래지스터화라고 한다 DevTools에서 페인트 레코드를 볼 떄마다 래스터화를 포함한 것으로 간주해야한다. 일부 아키텍쳐에서 그리기 호출 목록 생성과 래스터화가 다른 스레ㄷ에서 수행되는데, 이는 개발자가 제어 할 수 있는 부분이 아니다.

항상 모든 프레임에서 파이프 라인의 모든 부분을 건드릴 필요는 없다. 실제로 자바스크립트, CSS 또는 웹 에니메이션을 사용하여 시각적 변경을 숫행할 때 주어진 프레임에 대해 파이프라인이 정상적으로 작동하는 세 가지 방법이 있다.

#### 1. JS/CSS>스타일>레이아웃>페인트>합성
![](/resource/img/etc/frame-full.jpg)   


레이아웃 너비, 높이, 왼쪽 또는 상단 위치 등 요소의 기하학적 형태에 영향을 주는 'layout'속성을 변경하면 브라우저가 다른 요소를 확인하고 페이지에 대해 'reflow'를 수행해야 합니다. 영향을 받은 영역이 있으면 다시 페인트 해야하고 최종적으로 페인트한 요소는 다시 합성해야한다.



### 2. JS/CSS> 스타일>페인트> 합성
![](/resource/img/etc/frame-no-layout.jpg)   
페이지 레이아웃에 영향을 주지 않은 배경 이미지, 텍스트 색상 또는 그림자 등의 'paint only'속성을 변경하면, 브라우저가 레이아웃을 건너뛰되 페인트 작업은 여전히 수행한다.


### 3. JS/CSS>스타일>합성
![](/resource/img/etc/frame-no-layout-paint.jpg)   

레이아웃과 페인트가 필요 없는 속성을 변경하면 브라우저가 합성단계로 건너뜁니다.
이 최종버전은 앱의 생명 주기에 애니메이션이나 스크롤처럼 많은 부담을 주는 시점에 가장 이상적이고 비용이 가장 적게 드는 버전입니다.

성능은 가급적 작업을 피하고 작업을 효율적으로 실행하도록 만드는 기술이다. 대부분의 경우 성능은 브라우저에 도움이 됩니다. 위의 파이프라인에 나열된 작업의 컴퓨팅 비용이 다르다. 일부 작업은 다른 작업보다 비용이 많이든다.

파이프 라인의 다른 부분 즉 일반적인 문제와 단 방법을 살펴보자.


## REF
- https://developers.google.com/web/fundamentals/performance/rendering/
- https://csstriggers.com/
- https://www.udacity.com/course/browser-rendering-optimization--ud860