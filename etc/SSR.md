# Server Side Rendering

![](/resource\img\etc\SSRandSPA.png)


## Intro
1. 모바일 웹에 대한 니즈 증가에 따른 성능이슈
2. 데스크탑 웹과는 다른 렌더링 방식이 필요해짐
3. Single Page web Application(SPA)의 등장.
    - 트래픽 감소
    - 사용자 경험 개선.
    - Client-side rendering
    - Angular, BackboneJs
4. 클라이언트 프레임워크의 작업이 많아지면서 View만 관리하는 철학의 프레임워크 등장.
    - ReactJs


##  SinglePageApplicatoin(SPA)

![](/resource/img/etc/serversideRendering.png)  
SPA는 CRS방식으로 애플리케이션 생명 주기중에서 단 한번만 리소스(HTML,CSS,Javascript)를 로딩하고 그 후에는 데이터를 받아올 때만 서버와 통신한다.  
정리하자면 첫 요청시 딱 한번만 페이지를 불러오고 페이지 이동시 기존 페이지의 내부를 수정해서 보여주는 방식이다.  

사용자의 관점에서 말하자면 최초 페이지를 로딩한 시점부터는 페이지 리로딩 없이 필요한 부분만 서버로 부터 받아서 화면에 갱신하는 것을 말한다. 필요한 부분만 갱신하기 때문에 네이티브 엡에 가까운 페이지 이동과 사용자 경험을 제공한다.


### 장점.
1. 자연스러운 사용자 경험
2. 필요한 리소스만 부분적으로 로딩
3. 서버의 템플린 연산을 클라이언트로 분산하여 성능향상
4. 컴포넌트별 개발이 용이함.
5. 모바일 앱 개발을 염두에 둔다면 동일한 API를 사용하도록 설계 가능

### 단점
1. javaScript 파일을 번들링해서 한 번 받기 때문에 초기 구동 속도가 느릐다.
    - webpack의 code splitting으로 해결가능
2. 검색엔진최적화(SEO)가 어려움
    - SSR로 해결가능
3. 보안이슈
    - 프론트엔드의 비지니스로직 최소화




## CRS과 SSR 비교
![](/resource/img/etc/serversideRendering2.png)


### 1.Client-side rendering(CRS)

사용자의 행동에 따라 필요한 부분만 다시 읽어 들임.  
서버에서 렌더링하여 전체 페이지를 내려받는것 보다 빠른 인터렉션을 기대할 수 있음.  
서버에서는 JOSN파일을 보내주고 자바스크립트가 JSON파일을 기준으로 HMTL을 그림(즉 렌더링을 브라우저에서 java script로 수행함.)

뷰 렌더링은 브라우저가 담당하고 필요한 데이터만 전달받아 보여주는 클라이언트 사이드 렌더링은 트래픽을 감소시켜서 쾌적한 경험을 사용자에게 제공함.


#### 장점
1. 트래픽 감소
    - 필요한 부분, 변경된 데이터만 렌더링함
2. 사용자 경험
    - 새로고침이 발생하지 않아 사용자가 네이티브 앱과 비슷한 경험을 함.

#### 단점
1. 초기 구동 속도가 느리다.
    - 페이지를 읽는 시간, 자바스크립트를 읽는 시간, 자바스크립트가 dom을 렌더링하는 시간.
2. 검색 엔진 최적화 문제.
    - 대부분 웹 크롤러, 봇들이 자바스크립트 파일을 실행시키지 못함.
    - 따라서 클라이언트 사이드 렌더링되는 페이지를 빈 페이지로 인식하게 된다.
    (구글형들의 검색엔진은 자바스크립트 엔진이 내장되어 이런 문제를 해결함)
3. 보안문제
    - 사용자 정보를 쿠키에 저장함으로서 보안문제가 생김.


### 2. Server-side rendering(SSR)
브라우저에 나타나는 형태 그대로를 HTML로 만들어 제공했음(전통 웹의 방식)  
그 다음 세대에서는 일부의 HTML과 Script만 브라우저로 전달하고 브라우저에서 Script를 실행시켜 서버에서 데이터를 조회하여 새로운 HTML을 생성하는 방식(form submit)

이러한 방식은 정보제공이 많은 모던 웹에서는 성능이슈가 발생함. 요청마다 새로고침이 발생하여 페이지를 리로딩하여 서버로부터 모든 리소스를 전달받아 렌더링하기때문임.
이런 SSR방식은 서버 트래픽증가로 이어져 성능저하를 초래함.

#### 장점
- 초기구동속도가 빠르다.
1. 검색엔진(SEO) 최적화
2. 성능개선
    - 초기로딩속도가 빠름(렌더링된 HTML을 제공하기때문)

#### 단점
1. SPA를 구현했을시 단점
    1. 프로젝트가 복잡해짐
        - 리액트에서 버서사이드 랜더링을 구현할 경우 router와 redux오 함께 사용하다 보면 복잡해진다.
    2. 성능 악화 가능성
        - 서버사이드 렌더링을 할 경우, reactDomServer.renderToString함수를 쓰는데 동기방식으로 작동함. 따라서 이벤트 루프에 멈춤
        - 이런 문제는 라이브러리를 통해 비동기식으로 구현가능
2. 대안
    1. 메타케그만 넣어주기  
    서버쪽에서 라우트에따라 필요한 메타캐그만 넣어주는것 그러면 크롤러에선 해당페이지에 대한 기본 정보는 얻을 수 있다.
    2. Prerender  
    오직 검색엔진 최적화를 위해 필요한 기능.



## ref
[서버사이드렌더링](https://asfirstalways.tistory.com/244)
[리액트와서버사이드랜더링](https://velopert.com/3425)
[왜서버사이드렌더링인가?](https://subicura.com/2016/06/20/server-side-rendering-with-react.html)
[SPA에SSR적용하기](https://medium.com/aha-official/%EC%95%84%ED%95%98-%ED%94%84%EB%A1%A0%ED%8A%B8-%EA%B0%9C%EB%B0%9C%EA%B8%B0-1-spa%EC%99%80-ssr%EC%9D%98-%EC%9E%A5%EB%8B%A8%EC%A0%90-%EA%B7%B8%EB%A6%AC%EA%B3%A0-nuxt-js-cafdc3ac2053)