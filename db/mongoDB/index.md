# MongoDB

MongoDB는 NoSQL로 분류되는 크로스 플랫폼 도큐먼트 지향 데이터베이스 시스템이다. 
MySQL 처럼 전통적인 테이블-관계 기반의 **RDBMS가 아니며 SQL을 사용하지 않는다.  

- Not Only SQL 
- 고정된 슼키마를 가지고있지 않으며 JOIN같은것이 존재하지 않는다.  



## RDBMS의 한계
1. 데이터 스키마가 고정적이다.
2. 확장성
- 저장하거 처리해야할 데이터양이 늘어나면 여러 컴퓨터에 분산시키는 것이 아니라 해당 데이터 베이스 서버의 성능을 업그레이드 하는 방식으로 확장해야한다.


## MonggoDB에서는?
RDBMS의 한계를 극복한 NoSql데이터 베이스. 데이터베이스에 등록하는 데이터들은 유동적인 스키마를 가질 수 있음 종류가 같은 데이터라고 하더라도 새로 등록해야할 데이터 형식이 바뀐다고 하더라도 기존 데이터까지 수정할 필요가 없음.
서버의 데이터양이 늘어나도 한 컴퓨터에서만 처리하는 것이 아니라 여러 컴퓨터로 분산하여 처리할 수 있도록 화갖ㅇ하기 윕게 설계되어있음.


#### **RDBMS
relational database management system, RDBMS  
관계형 데이터베이스 관리 시스템


## 문서(Document)  
RDBMS의 record와 비슷한 개념입니다.  데이터구조는 한개 이상의 key-value쌍으로 이뤄져있습니다.  

```js
{
    "_id": ObjectId("5099803df3f4948bd2f98391"),
    "username": "velopert",
    "name": { first: "M.J.", last: "Kim" }
}
```
각 문서는 고유의 시간/머신ID/프로세스ID/순차번호로 이뤄진 _id로 구분됩니다.  

문서는 동적인 스키마를 가질 수 있습니다.  여러 문서들이 들어있는 곳을 컬렉션이라고 부릅니다.  
RDBMS의 테이블과 비슷하다고 할 수 있습니다. 가장 큰 차이는 스키마가 없기 때문에 구조가 다른 데이터를 삽입할 수 있다는 점입니다.  


```js
{ 
    "_id": ObjectId("594948a081ad6e0ea526f3f5"),
    "username": "velopert"
},
{ 
    "_id": ObjectId("59494fca81ad6e0ea526f3f6"),
    "username": "nakim",
    "phone": "010-3333-6666"
}
```
이처럼 구조가 다른 문서를 하나의 컬렉션에 담을 수 있습니다.  


## 스키마 디자인

블로그 포스팅에 댓글을 입력한 상황을 가정해보겠습니다.  
RDBMS의 경우 포스팅 테이블과 댓글테이블을 별도로 관리하며 JOIN을 통해 두개의 테이블 정보를 병합해야합니다.  

반면 MongoDB에서는 데이터 스키마를 디자인할떄 한 문서에 최대한 많은 데이터를 넣는것을 권장합니다.  
즉 포스팅 문서에 댓글이 포함되는 구조입니다.  이를 서브다큐먼트라고 부릅니다.  
서브다큐먼트도 일반 문서를 다루는 것 처럼 쿼리를 할 수 있습니다.  

한 문서에는 16MB 만큼의 데이터를 넣을 수 있습니다. 100자의 덧글이라면 대략 0.24KB 를 차지하는데요, 16MB 는 16,384KB 이고, 이를 계산하면 한 문서에는 대략 68,000 가량의 덧글을 작성 할 수 있습니다.  

만약 이 용량을 초과할 가능성이 있다면 덧글 컬랙션과 포스팅 컬랙션으로 각각 분리하는것이 좋습니다.  
또다른 분리의 예는 두개의 컬렉션중 정보변경이 하나가 정보변경이 잦은 경우입니다.  

예를들어 책과 저자를 하나의 컬렉션으로 관리하는데 책의 저자를 자주 수정해야하는 경우라면
저자를 별도의 컬렉션으로 빼서 관리하는것이 좋습니다.  


### 다뤄볼 주제
- Mongoose
- 기본 쿼리


## REF 
- [velopert](https://backend-intro.vlpt.us/2/)