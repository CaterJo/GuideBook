# JSP

## 1. 정의
Java Server Pages.
자바 프로그램과 HTML태그를 포함한 Server Side 애플리케이션 개발기술

HTML내에 자바 코드를 삽입하여 웹서버에서 동적으로 웹 페이지를 생성하여 웹브라우저에 돌려주는 언어이다.
JSP는 실행시 자바 스ㅓ블릿으로 변환된 후 실행되므로 서블릿과 거의 유사하다고 볼 수 있다.
하지만 서블릿과 달리 HTML표준에 따라 작성되므로 웹디자인하기에 편리하다.
JSTML등의 JSP 태그 라이브러리를 사용하는 경우에는 자바 코딩없이 태그만 간략히 기술이 가능하여 생산성이 향상된다.


서블릿 기반의 서버 스크립트 기술,
"스크립트 기술"이란 미리 약속된 규정에 따라 간단한 키워드 조합을 입력하면, 실행시점에 그 각각의 키워드에 맵핑되어 있느 어떤 코드로 변환 후에 실행되는 형태
JSP는 사용자가 요청하면 tomcat같은 was(웹 어플리케이션 서버)에 의해 내부적으로 서블릿으로 만들어져 실행된다.
JSP가 서블릿을 기반으로 하고 있기 때문에 JSP의 동작방식을 이해하기 위해선 서블릿에 대한 이해가 필요하다.

## 등장배경.

서블릿은  java코드 안에 html태그가 섞여 있어서 작업에 대한 분리적 측면에서 효율떨어지기 떄문에 프로그래밍하기에 상대적으로 어렵고
수정이 어려운 단점이 있다. 이러한 불편함을 해결하기 위해 JSP 등장했다.  
단, 로직과 디자인이 한 파일내에 섞여 있어 유지보수가 어렵다는 단점이 있다.


**MODEL1**  
- JSP만 이용한 개발
- 자바소스에서 HTML소스를 동적으로 삽입하는 방식.
- 개발 속도가 빠르고 배우기 쉽다.
- 프리젠테이션 로직과 비지니스로직 혼재
- JSP 코드가 복잡해수서 유지보수가 어렵다.


**MODEL2**  
서블릿+JSP 형태의 개발
1. JSP 
	- 장점을 최대한 활용할 수 있는 웹 어플리케이션 구조에서 사용자에게 결과를 보여주는 프리젠테이션 층을 담당한다.
	- 최소한의 자바코드만 코딩
	- 서블릿에서 작성되던 html태그를 JSP에 전담한다.
2. 서블릿
	- 서블릿의 장점을 최대한 활용할 수 있는 사용자의 응답을 받아서 분석하고 비지니스 층과 통신하여 처리하고 처리결과를 다시 사용자에게 응답하는 컨트롤러 역할을 담당한다.




## 특징
- java의 장점을 그대로 사용
- 다양한 Serlvet간의 데이터 공유
- 많은 사요자의 원활한 접속처리
- 세계적인 업체의 강력한 지원
- SERVLET, EjB등의 기술과 융합.
- SERVLET의 장점은 그대로 갖추고 작성하기가 쉽다는 장점이 더해진 것이다. 또한 SERVLET에서 문제가 되었던 표현부와 구현부 분리의 어려움 해결
- JSP2.0부터 JSTL을 완전히 지원하고 사용자 정의 태그의 작성이 더욱 쉬워짐에 따라 코드 가독성 향상.
- 프로그램 작성 및 유지 보수가 쉬워졌다.
- 보완성이 뛰어나다
- 코딩이 어렵고 asp에 비해 코드량이 1.5배 가량된다.
- 실행호나경 리눅스와 윈도우즈
- JVM이라는 프로그램이 설치되면 기종을 가리지 않고 사용가능.
- HMTL 내부에 Java 코드가 있어서 HTML코드를 작성하기 쉽다.
- 로직과 디자인이 한 파일에 섞여있어 유지보수가 어렵다
- 클래스 단위로 분해해서 객체지향적 코딩이 어렵다.
- JSP는 내부적으로 WAS에 의해서 SERVLET으로 바뀌어 실행된다.





## 장점
- 세밀한 제어를 통한 성능 발휘
- 동적인 콘텐츠 기능을 수행하는 webApp의 개발과 유지보수의 기능을 각각 처리할 수 있다.
- 플랫폼과 web서버에 독립적으로 구현이 가능하다.
- 객체 지향적
- 플랫폼 독립적
- 네트워크 지향적
- 뛰어난 보안
- 멀티 쓰레드기능
- 친절한 코드




	
## 단점
- 생산성이 떨어진다.
- 기술장벽이 있다.



## JSP 요청시 처리흐름.

![](/resource/img/java/JSP_1.jpg)

1. 클라이언트의 요청을 받은 웹서버는 요청 URL에 "main.JSP"의 포함여부를 확인하여 JSP 요청을 확인한다.
2. JSP요청일 경우 WAS(서블릿 컨테이너)에 전송한다. 
3. WAS는 해당 JSP파일을 찾아서 SERVLET 소스파일을 생성한다(main_JSP.java)
4. 서블릿 파일은 컴파일 되어 서블릿 클래스 파일(main_JSP.class)을 생성하고 Heep 메모리에 로드한다.
5. 최종적으로 HTML 형태가 된 서블릿 수행 결과를 웹 서버에 전송한다.
6. 사용자는 서블릿의 출력 결과인 HTML 형태로 응답 결과를 받음.

----
		
## JSP 동작 구조
1) 클라이언트가 JSP 페이지를 요청	
2) 웹서버는 JSP에 대한 요청을 웹컨테이너에 처리를 넘김
3) 컨테이너가 JSP파일을 찾는다. 만일JSP파일이 최초 요청되었다면, 서블릿으로 파싱한다.
	- 이전에 요청됐던 페이지라면 파싱하지 않고 파싱했던 클래스파일을 메모리에 적재
4) 서블릿파일(.java)은 클래스파일(.class)로 컴파일된다.
5) 클래스파일은 메모리에 로딩되어 실행된다.
6) 실행된 결과는 웹서버에 넘겨진다.
7) 웹 서버는 웹브라우저가 인식하는 HTML형태로만 결과를 응답한다.
	(*브라우저 : HTMl태그로 구서오딘 페이즈를 실행시켜주는 프로그램)
	
----


##  JSP 컨테이너
- 서블릿 컨테이너의 개념과 동일하다
- 실제로 서블릿 컨테이너가 JSP컨테이너가 된다.
- JSP는 완전히 스크립트 형식으로 동작하지 않고 서블릿으로 변환 된 이후에 실행되기 때문
- JSP를 SERVLET으로 컴파일해주는 것이 JSP 엔진이다.
- JSP를 컴파일하고 동작을 시켜주는 것을 특정 서블릿이 담당하고 있다.
- JSP가 완전한 SERVLET으로 컴파일되지는 않는다.
- JSP, SERVLET이 구동할 수 있는 형태의 SERVLET으로 바뀌게 되는것을 의미한다.
- JSP 컨테이너는 SERVLET으로 변환하는 과정에서 pasing과정이 하나 더 켜져 있는 것이고 나머지는 똑같다.

- JSP는 서버 측에서 동작하고 웹 서버와 연동이 되어 동적인 페이지를 생성한다.
- JSP가 동작하는 곳이 서버의 환경이라는 것이다.
- 따라서 JSP를 사용하기 위해서는 서버환경(웹서버+웹컨테이너)이 구축되어 이어야한다.
- 대부분의 웹 컨테이너는 웹서버 기능을 가지고 있다.






## SAMPLE

``` html
<%@page import="java.util.Calendar" %> 
<%@ page contentType="text/html; charset=UTF-8"%> 

<% 
	String str=String.format("%tF",Calendar.getInstance());
 %> 
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 

<html> 

<head> 
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
	<title>Insert title here</title> 
</head> 
	<body> 
		오늘은 <%=str%><br/> 한시간만 참으면 점심.... 
	</body> 
</html>
```

## ref
https://linked2ev.github.io/devlog/2018/10/17/JSP-1.-What-JSP/